---
title: "Example charts"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Example charts}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, include = FALSE}
devtools::load_all()
library(biomaRt)
```

### *E.coli* Lac operon

<details>
<summary>Click to see the code</summary>
```{r echo=TRUE, results='hide'}
lacZ_operon <- data.frame(
  start = c(361249, 361926, 363231, 366428), 
  stop = c(361860, 363179, 366305, 367510), 
  Gene_symbol = c("lacA", "lacY", "lacZ", "lacI"), 
  Strand = c("minus", "minus", "minus", "minus"), 
  NCBI_Gene_ID = as.character(c(945674, 949083, 945006, 945007)), 
  Description = c("galactoside O-acetyltransferase", 
                  "lactose permease", "beta-galactosidase", 
                  "DNA-binding transcriptional repressor LacI")
)

GC_chart(lacZ_operon, group = "Gene_symbol", height = "140px") %>%
  GC_labels() %>%
  GC_scaleBar(title = "0.2 kb", scaleBarUnit = 200, y=30) %>%
  GC_tooltip(
    formatter = "
    <b>ID:</b> {NCBI_Gene_ID}<br>
    <b>Description:</b> {Description}<br>
    <b>Start:</b> {start}<br>
    <b>Stop:</b> {stop}",
  ) %>%
  GC_title ("The Lac operon") %>%
  GC_footer(
    position = "middle",
    y = -30,
    subtitle = "Escherichia coli str. K-12 substr. MG1655" 
  ) %>%
  GC_coordinates(
    rotate = 0,
    tickValuesBottom = c(min(lacZ_operon$start), max(lacZ_operon$stop)),
    textStyle = list(x = -25, y = 22, fontSize = "10px"),
    tickStyle = list(lineLength = 10)
    ) %>%
  GC_legend(FALSE)
```
</details>

```{r echo = FALSE, results='asis'}
lacZ_operon <- data.frame(
  start = c(361249, 361926, 363231, 366428), 
  stop = c(361860, 363179, 366305, 367510), 
  Gene_symbol = c("lacA", "lacY", "lacZ", "lacI"), 
  Strand = c("minus", "minus", "minus", "minus"), 
  NCBI_Gene_ID = as.character(c(945674, 949083, 945006, 945007)), 
  Description = c("galactoside O-acetyltransferase", 
                  "lactose permease", "beta-galactosidase", 
                  "DNA-binding transcriptional repressor LacI")
)

GC_chart(lacZ_operon, group = "Gene_symbol", height = "140px") %>%
  GC_labels() %>%
  GC_scaleBar(title = "0.2 kb", scaleBarUnit = 200, y=30) %>%
  GC_tooltip(
    formatter = "
    <b>ID:</b> {NCBI_Gene_ID}<br>
    <b>Description:</b> {Description}<br>
    <b>Start:</b> {start}<br>
    <b>Stop:</b> {stop}",
  ) %>%
  GC_title ("The Lac operon") %>%
  GC_footer(
    position = "middle",
    y = -40,
    subtitle = "Escherichia coli str. K-12 substr. MG1655" 
  ) %>%
  GC_coordinates(
    rotate = 0,
    tickValuesBottom = c(min(lacZ_operon$start), max(lacZ_operon$stop)),
    textStyle = list(x = -25, y = 22, fontSize = "10px"),
    tickStyle = list(lineLength = 10)
    ) %>%
  GC_legend(FALSE)
```
